## 003 æ³›å‹åŒ–å¾Œçš„çµæ§‹è®ŠåŒ–ï¼ˆä¸æ¨å€’ï¼Œå¼·åŒ–é‚Šç•Œï¼‰

ğŸ§­ æ‘˜è¦

- æ³›å‹åŒ–ä¸æœƒæ¨ç¿»ç¾æœ‰çµæ§‹ï¼Œåªæœƒè®“é‚Šç•Œæ›´ç¡¬ã€æ›´æ¸…æ¥šã€‚
- ä¸‰å€‹å±¤çš„è²¬ä»»ï¼šcore-engineï¼ˆå†·ï¼‰ã€saas-domainï¼ˆèƒ–ä¸€é»ï¼Œèªæ„å›ä¾†ï¼‰ã€platform-adaptersï¼ˆå¹¾ä¹ä¸å‹•ï¼‰ã€‚
- Replay / Determinism æ›´ä½³ï¼šSaga ç´”å‡½æ•¸ï¼Œé‡æ’­ = é‡è·‘ã€‚

### Table of Contents

- [ç¾æ³çµæ§‹](#ç¾æ³çµæ§‹)
- [è§’è‰²åˆ†å·¥æœƒè®Šä»€éº¼](#è§’è‰²åˆ†å·¥æœƒè®Šä»€éº¼)
- [å¯èƒ½æ–°å¢çš„ Router å±¤](#å¯èƒ½æ–°å¢çš„-router-å±¤)
- [ç‚ºä»€éº¼å®‰å…¨](#ç‚ºä»€éº¼å®‰å…¨)
- [é‚Šç•Œè­¦æˆ’](#é‚Šç•Œè­¦æˆ’)
- [ä¸€å¥è©±ç¸½çµ](#ä¸€å¥è©±ç¸½çµ)

### ç¾æ³çµæ§‹

```
packages/
â”œâ”€ core-engine/          â† äº‹ä»¶ / Saga / æµç¨‹å¼•æ“ï¼ˆç„¡æ¥­å‹™ï¼‰
â”œâ”€ saas-domain/          â† æ¥­å‹™äº‹ä»¶ã€Aggregateã€Saga å¯¦ä½œ
â”œâ”€ platform-adapters/    â† Firebase / PubSub / Scheduler
â”œâ”€ ui-angular/           â† Projection / Query / View
```

### è§’è‰²åˆ†å·¥æœƒè®Šä»€éº¼

1) **core-engine æ›´å†·**ï¼š  
   - `Event<TType, TPayload>`ã€`Saga<TContext, TEvent>`ã€`SagaEngine`ã€‚  
   - ä¸çŸ¥é“ Task / Workspace / Billingã€‚
2) **saas-domain ç¨èƒ–**ï¼š  
   - äº‹ä»¶èˆ‡èªæ„å›åˆ° domainï¼ŒSaga ä¹Ÿå›åˆ° domainã€‚  
   - æ²’æœ‰é‡æ§‹ç—›ï¼Œåªæœ‰ã€Œè©²è¬›è©±çš„äººè¬›è©±ã€ã€‚
3) **platform-adapters å¹¾ä¹ä¸å‹•**ï¼š  
   - Event æ³›å‹ã€Context æ³›å‹ï¼ŒFirebase / PubSub ç„¡æ„Ÿã€‚  
   - ä»ç„¶è² è²¬ EventStoreã€MessageBusã€Schedulerã€‚

### å¯èƒ½æ–°å¢çš„ Router å±¤

```
core-engine
â”œâ”€ EventDispatcher
â”‚    â””â”€ SagaRouter
â”‚          â””â”€ WorkspaceProvisionSaga
â”‚          â””â”€ BillingSaga
```

Router åƒ…åšäº‹ä»¶ â†’ Saga è¨‚é–±æ˜ å°„ï¼Œæ²’æœ‰æ¥­å‹™åˆ¤æ–·ã€‚  
æ¢ä»¶ï¼šä¸è¦æŠŠ Router å¯«æˆ policy engineã€‚

### ç‚ºä»€éº¼å®‰å…¨

- Saga = ç´”å‡½æ•¸ â†’ Replay / Projection rebuild / Debug time-travel éƒ½æ›´ç©©ã€‚  
- å¼•æ“å±¤ã€Œç‰©ç†æ³•å‰‡ã€æ¸…æ¥šï¼Œdomain èªè¨€æ­¸ä½ã€‚  
- åªè¦ä¸è®“ core-engine çŸ¥é“ enum æˆ– domain nounï¼Œå°±ä¸æœƒå´©ã€‚

### é‚Šç•Œè­¦æˆ’

- âŒ core-engine ä¸èƒ½å‡ºç¾ï¼šäº‹ä»¶ enumã€Workspace/Task/Billing åè©ã€Firebase å‹åˆ¥ã€‚  
- âŒ saas-domain ä¸ç›´æ¥ç¢°ï¼šEvent Store å¯¦ä½œã€Message Bus SDKã€‚  
- âœ… platform-adapters åªå¯¦ä½œ portsï¼Œä¸å·å¡èªæ„ã€‚

### ä¸€å¥è©±ç¸½çµ

> å¼•æ“å±¤ä¸æ˜¯æ¥­å‹™çš„æŠ½è±¡ï¼Œå®ƒæ˜¯ã€Œå› æœæµå‹•çš„ç‰©ç†å®šå¾‹ã€ã€‚  
> æŠŠèªè¨€é‚„çµ¦ Domainï¼ŒæŠŠåŠ›å­¸é‚„çµ¦ Engineï¼Œçµæ§‹æ›´ç›´ä¹Ÿæ›´ç©©ã€‚

// END OF FILE
